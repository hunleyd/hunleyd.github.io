<!DOCTYPE html>
<HTML>
    <HEAD>
    <TITLE>
        
          Getting fancy with PostgreSQL and Homebrew
        
        Douglas J Hunley - It's not that I'm anti-social; I'm just not user-friendly
    </TITLE>

    <META charset='utf-8' />
<META content='text/html; charset=utf-8' http-equiv='Content-Type' />
<META http-equiv='X-UA-Compatible' content='IE=edge' />
<META name='author' content='Douglas J Hunley' />
<META name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0' />


  <META name='description' content='In our previous post, we installed PostgreSQL via Homebrew and got our own little cluster up and running under our userid. That is probably good enough for 90% of the users out there who just want to play with or devel on PostgreSQL, but for those of us who need a little more flexibility in our installs, we&#39;re going to take the next step.
' />
  <META property='og:description' content='In our previous post, we installed PostgreSQL via Homebrew and got our own little cluster up and running under our userid. That is probably good enough for 90% of the users out there who just want to play with or devel on PostgreSQL, but for those of us who need a little more flexibility in our installs, we&#39;re going to take the next step.
' />



  <META property='og:title' content='Getting fancy with PostgreSQL and Homebrew' />
  <META property='twitter:title' content='Getting fancy with PostgreSQL and Homebrew' />



    <!--[if lt IE 9]>
        <SCRIPT src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></SCRIPT>
    <![endif]-->

    <LINK rel="alternate" type="application/rss+xml" title="Douglas J Hunley - It's not that I'm anti-social; I'm just not user-friendly" href="/feeds/feed.xml" />

<LINK rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<LINK rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-mfizz/2.3.0/font-mfizz.css" />
<LINK rel="stylesheet" type="text/css" href="/style.css" />

</HEAD>

    <BODY>
    <DIV class="body_container">
        <DIV class="content_container">
    <DIV class="posts_container">
    <DIV class="posts_header_container clearfix">
        <H2 class="site-name">
            <A href="/">Douglas J Hunley</A>
        </H2>
        <P class="site-description">It's not that I'm anti-social; I'm just not user-friendly</P>
    </DIV>
    <DIV class="posts_content_container">
        <ARTICLE class="post">
  <H1>Getting fancy with PostgreSQL and Homebrew</H1>
  
    <DIV class="meta">
      <TIME datetime="2016-11-10">
        November 10, 2016
      </TIME>
      <UL class="tag_list_in_post">
        
          <LI class="tag_list_item"><a class="tag_list_link" href="/tag/osx">osx</a></LI>
        
          <LI class="tag_list_item"><a class="tag_list_link" href="/tag/postgresql">postgresql</a></LI>
        
      </UL>
    </DIV>
  
  <DIV class="entry">
    <p><img src="http://cdn.curvve.com/wp-content/uploads/2013/09/homebrew_osx_logo.png" border=0 align=right style="PADDING-LEFT: 5px">In our <a href="https://hunleyd.github.io/PostgreSQL-Homebrew-and-You/">previous</a> post, we installed PostgreSQL via Homebrew and got our own little cluster up and running under our userid. That is probably good enough for 90% of the users out there who just want to play with or devel on PostgreSQL, but for those of us who need a little more flexibility in our installs, we&#39;re going to take the next step.</p>

<p>First, if you have any data in your existing cluster that you want to preserve, let&#39;s backup it up. We&#39;re just going to use <code>pg_dumpall</code> here since it&#39;s quick-n-dirty:</p>

<p><noscript><pre><code>bash
doug@Douglass-MacBook-Pro ~ ¬ª
doug@Douglass-MacBook-Pro ~ ¬ª pg_dumpall -g &amp;gt; my_roles.sql
doug@Douglass-MacBook-Pro ~ ¬ª pg_dumpall &amp;gt; my_data.sql
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre></noscript><script src="https://gist.github.com/hunleyd/22e765b45c877b5c9c2e35722b464393.js"> </script></p>

<p>Now, we can stop our cluster:</p>

<p><noscript><pre><code>bash
doug@Douglass-MacBook-Pro ~ ¬ª
doug@Douglass-MacBook-Pro ~ ¬ª brew services stop postgresql
Stopping `postgresql`... (might take a while)
==&amp;gt; Successfully stopped `postgresql` (label: homebrew.mxcl.postgresql)
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre></noscript><script src="https://gist.github.com/hunleyd/f02a36a115c3fed3310e7abc5f3fb419.js"> </script></p>

<p>And uninstall the current PostgreSQL:</p>

<p><noscript><pre><code>bash
doug@Douglass-MacBook-Pro ~ ¬ª
doug@Douglass-MacBook-Pro ~ ¬ª brew uninstall postgresql
Uninstalling /usr/local/Cellar/postgresql/9.5.5... (3,154 files, 35.1M)
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre></noscript><script src="https://gist.github.com/hunleyd/4dffee8e9ebbf2c052162f2ecc36e812.js"> </script></p>

<p>And remove the remnants of our cluster:</p>

<p><noscript><pre><code>bash
doug@Douglass-MacBook-Pro ~ ¬ª
doug@Douglass-MacBook-Pro ~ ¬ª rm -rf /usr/local/var/postgres
doug@Douglass-MacBook-Pro ~ ¬ª
</code>
</pre></noscript><script src="https://gist.github.com/hunleyd/7c064e25c8916fa7fe0e3cdb846d3c78.js"> </script></p>

<p>Now we&#39;ve got a clean slate. So, let&#39;s tell Homebrew to stop using the default PostgreSQL and use Peter Eisentraut&#39;s version (if you don&#39;t know, Peter actually contributes to PostgreSQL):</p>

<p><noscript><pre>```bash
doug@Douglass-MacBook-Pro ~ ¬ª 
doug@Douglass-MacBook-Pro ~ ¬ª brew tap petere/postgresql
Updating Homebrew...
==&gt; Auto-updated Homebrew!
Updated 1 tap (homebrew/core).
==&gt; New Formulae
[snip]
==&gt; Updated Formulae
[snip]
==&gt; Deleted Formulae
[snip]</p>

<p>==&gt; Tapping petere/postgresql
Cloning into &#39;/usr/local/Homebrew/Library/Taps/petere/homebrew-postgresql&#39;...
remote: Counting objects: 15, done.
remote: Compressing objects: 100% (11/11), done.
remote: Total 15 (delta 9), reused 5 (delta 4), pack-reused 0
Unpacking objects: 100% (15/15), done.
Checking connectivity... done.
Tapped 11 formulae (49 files, 71.7K)
doug@Douglass-MacBook-Pro ~ ¬ª 
```</pre></noscript><script src="https://gist.github.com/hunleyd/b099ff10c1cd1713f37ff40cf320adf3.js"> </script></p>

<p>As of this writing, Peter makes PostgreSQL 8.3 and above available. However, only PostgreSQL 9.2 and above are officially supported by the PostgreSQL community. So let&#39;s install the supported versions:</p>

<p><noscript><pre>```bash
doug@Douglass-MacBook-Pro ~ ¬ª
doug@Douglass-MacBook-Pro ~ ¬ª for i in $(seq 2 6)
\ do
\ brew install postgresql-9.${i}
\ done
==&gt; Installing postgresql-9.2 from petere/postgresql
==&gt; Tapping homebrew/dupes
Cloning into &#39;/usr/local/Homebrew/Library/Taps/homebrew/homebrew-dupes&#39;...
remote: Counting objects: 42, done.
remote: Compressing objects: 100% (42/42), done.
remote: Total 42 (delta 0), reused 4 (delta 0), pack-reused 0
Unpacking objects: 100% (42/42), done.
Checking connectivity... done.
Tapped 38 formulae (103 files, 121.4K)
==&gt; Installing dependencies for petere/postgresql/postgresql-9.2: gettext, homebrew/dupes/openldap, ossp-uuid, homebrew/dupes/tcl-tk
==&gt; Installing petere/postgresql/postgresql-9.2 dependency: get
==&gt; Downloading https://homebrew.bintray.com/bottles/gettext-0.19.8.1.sierra.bot</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Pouring gettext-0.19.8.1.sierra.bottle.tar.gz
==&gt; Caveats
This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>macOS provides the BSD gettext library and some software gets confused if both are in the library path.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/gettext/lib
CPPFLAGS: -I/usr/local/opt/gettext/include
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/gettext/0.19.8.1: 1,934 files, 16.9M
==&gt; Installing petere/postgresql/postgresql-9.2 dependency: homebrew/dupes/
==&gt; Downloading https://homebrew.bintray.com/bottles-dupes/openldap-2.4.44.sierr</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Pouring openldap-2.4.44.sierra.bottle.tar.gz
==&gt; Caveats
This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>macOS already provides this software and installing another version in
parallel can cause all kinds of trouble.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/openldap/lib
CPPFLAGS: -I/usr/local/opt/openldap/include
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/openldap/2.4.44: 295 files, 6.3M
==&gt; Installing petere/postgresql/postgresql-9.2 dependency: ossp-uuid
==&gt; Downloading https://homebrew.bintray.com/bottles/ossp-uuid-1.6.2_2.sierra.bo</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Pouring ossp-uuid-1.6.2<em>2.sierra.bottle.tar.gz
üç∫   /usr/local/Cellar/ossp-uuid/1.6.2</em>2: 17 files, 206K
==&gt; Installing petere/postgresql/postgresql-9.2 dependency: homebrew/dupes/
==&gt; Using the sandbox
==&gt; Downloading https://downloads.sourceforge.net/project/tcl/Tcl/8.6.6/tcl8.6.6
==&gt; Downloading from http://iweb.dl.sourceforge.net/project/tcl/Tcl/8.6.6/tcl8.6</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; ./configure --prefix=/usr/local/Cellar/tcl-tk/8.6.6 --mandir=/usr/local/Cell
==&gt; make
==&gt; make install
==&gt; make install-private-headers
==&gt; Downloading https://downloads.sourceforge.net/project/tcl/Tcl/8.6.6/tk8.6.6-
==&gt; Downloading from http://heanet.dl.sourceforge.net/project/tcl/Tcl/8.6.6/tk8.</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; ./configure --prefix=/usr/local/Cellar/tcl-tk/8.6.6 --mandir=/usr/local/Cell
==&gt; make TK<em>LIBRARY=/usr/local/Cellar/tcl-tk/8.6.6/lib
==&gt; make install
==&gt; make install-private-headers
==&gt; Downloading https://github.com/tcltk/tcllib/archive/tcllib</em>1<em>18.tar.gz
==&gt; Downloading from https://codeload.github.com/tcltk/tcllib/tar.gz/tcllib</em>1_18</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; ./configure --prefix=/usr/local/Cellar/tcl-tk/8.6.6 --mandir=/usr/local/Cell
==&gt; make install
==&gt; Caveats
This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>Tk installs some X11 headers and OS X provides an (older) Tcl/Tk.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/tcl-tk/lib
CPPFLAGS: -I/usr/local/opt/tcl-tk/include
PKG_CONFIG_PATH: /usr/local/opt/tcl-tk/lib/pkgconfig
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/tcl-tk/8.6.6: 2,847 files, 29.2M, built in 5 minutes 31 seconds
==&gt; Installing petere/postgresql/postgresql-9.2
==&gt; Downloading https://ftp.postgresql.org/pub/source/v9.2.19/postgresql-9.2.19.</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Patching
patching file contrib/uuid-ossp/uuid-ossp.c
==&gt; ./configure --prefix=/usr/local/Cellar/postgresql-9.2/9.2.19 --enable-dtrace
==&gt; make install-world
==&gt; Caveats
To use this PostgreSQL installation, do one or more of the following:</p>

<ul>
<li>Call all programs explicitly with /usr/local/opt/postgresql-9.2/bin/...</li>
<li>Add /usr/local/opt/postgresql-9.2/bin to your PATH</li>
<li>brew link -f postgresql-9.2</li>
<li>Install the postgresql-common package</li>
</ul>

<p>To access the man pages, do one or more of the following:
- Refer to them by their full path, like <code>man /usr/local/opt/postgresql-9.2/share/man/man1/psql.1</code>
- Add /usr/local/opt/postgresql-9.2/share/man to your MANPATH
- brew link -f postgresql-9.2</p>

<p>This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>The different provided versions of PostgreSQL conflict with each other.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/postgresql-9.2/lib
CPPFLAGS: -I/usr/local/opt/postgresql-9.2/include
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/postgresql-9.2/9.2.19: 3,120 files, 40M, built in 3 minutes 28 seconds
Updating Homebrew...
==&gt; Auto-updated Homebrew!
Updated 1 tap (homebrew/core).
==&gt; Updated Formulae
[snip]</p>

<p>==&gt; Installing postgresql-9.3 from petere/postgresql
==&gt; Downloading https://ftp.postgresql.org/pub/source/v9.3.15/postgresql-9.3.15.</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Patching
patching file contrib/uuid-ossp/uuid-ossp.c
==&gt; ./configure --prefix=/usr/local/Cellar/postgresql-9.3/9.3.15 --enable-dtrace
==&gt; make install-world
==&gt; Caveats
To use this PostgreSQL installation, do one or more of the following:</p>

<ul>
<li>Call all programs explicitly with /usr/local/opt/postgresql-9.3/bin/...</li>
<li>Add /usr/local/opt/postgresql-9.3/bin to your PATH</li>
<li>brew link -f postgresql-9.3</li>
<li>Install the postgresql-common package</li>
</ul>

<p>To access the man pages, do one or more of the following:
- Refer to them by their full path, like <code>man /usr/local/opt/postgresql-9.3/share/man/man1/psql.1</code>
- Add /usr/local/opt/postgresql-9.3/share/man to your MANPATH
- brew link -f postgresql-9.3</p>

<p>This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>The different provided versions of PostgreSQL conflict with each other.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/postgresql-9.3/lib
CPPFLAGS: -I/usr/local/opt/postgresql-9.3/include
PKG_CONFIG_PATH: /usr/local/opt/postgresql-9.3/lib/pkgconfig
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/postgresql-9.3/9.3.15: 3,190 files, 41M, built in 3 minutes 17 seconds
==&gt; Installing postgresql-9.4 from petere/postgresql
==&gt; Installing dependencies for petere/postgresql/postgresql-9.4: e2fsprogs
==&gt; Installing petere/postgresql/postgresql-9.4 dependency: e2fsprogs
==&gt; Downloading https://homebrew.bintray.com/bottles/e2fsprogs-1.42.13.sierra.bo</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Pouring e2fsprogs-1.42.13.sierra.bottle.tar.gz
==&gt; Caveats
This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>This brew installs several commands which override macOS-provided file system commands.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/e2fsprogs/lib
CPPFLAGS: -I/usr/local/opt/e2fsprogs/include
PKG_CONFIG_PATH: /usr/local/opt/e2fsprogs/lib/pkgconfig
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/e2fsprogs/1.42.13: 135 files, 5.0M
==&gt; Installing petere/postgresql/postgresql-9.4
==&gt; Downloading https://ftp.postgresql.org/pub/source/v9.4.10/postgresql-9.4.10.</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; ./configure --prefix=/usr/local/Cellar/postgresql-9.4/9.4.10 --enable-dtrace
==&gt; make install-world
==&gt; Caveats
To use this PostgreSQL installation, do one or more of the following:</p>

<ul>
<li>Call all programs explicitly with /usr/local/opt/postgresql-9.4/bin/...</li>
<li>Add /usr/local/opt/postgresql-9.4/bin to your PATH</li>
<li>brew link -f postgresql-9.4</li>
<li>Install the postgresql-common package</li>
</ul>

<p>To access the man pages, do one or more of the following:
- Refer to them by their full path, like <code>man /usr/local/opt/postgresql-9.4/share/man/man1/psql.1</code>
- Add /usr/local/opt/postgresql-9.4/share/man to your MANPATH
- brew link -f postgresql-9.4</p>

<p>This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>The different provided versions of PostgreSQL conflict with each other.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/postgresql-9.4/lib
CPPFLAGS: -I/usr/local/opt/postgresql-9.4/include
PKG_CONFIG_PATH: /usr/local/opt/postgresql-9.4/lib/pkgconfig
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/postgresql-9.4/9.4.10: 3,261 files, 42.9M, built in 3 minutes 17 seconds
==&gt; Installing postgresql-9.5 from petere/postgresql
==&gt; Downloading https://ftp.postgresql.org/pub/source/v9.5.5/postgresql-9.5.5.ta</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; ./configure --prefix=/usr/local/Cellar/postgresql-9.5/9.5.5 --enable-dtrace
==&gt; make install-world
==&gt; Caveats
To use this PostgreSQL installation, do one or more of the following:</p>

<ul>
<li>Call all programs explicitly with /usr/local/opt/postgresql-9.5/bin/...</li>
<li>Add /usr/local/opt/postgresql-9.5/bin to your PATH</li>
<li>brew link -f postgresql-9.5</li>
<li>Install the postgresql-common package</li>
</ul>

<p>To access the man pages, do one or more of the following:
- Refer to them by their full path, like <code>man /usr/local/opt/postgresql-9.5/share/man/man1/psql.1</code>
- Add /usr/local/opt/postgresql-9.5/share/man to your MANPATH
- brew link -f postgresql-9.5</p>

<p>This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>The different provided versions of PostgreSQL conflict with each other.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/postgresql-9.5/lib
CPPFLAGS: -I/usr/local/opt/postgresql-9.5/include
PKG_CONFIG_PATH: /usr/local/opt/postgresql-9.5/lib/pkgconfig
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/postgresql-9.5/9.5.5: 3,395 files, 45M, built in 3 minutes 30 seconds
==&gt; Installing postgresql-9.6 from petere/postgresql
==&gt; Downloading https://ftp.postgresql.org/pub/source/v9.6.1/postgresql-9.6.1.ta</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; ./configure --prefix=/usr/local/Cellar/postgresql-9.6/9.6.1 --enable-dtrace
==&gt; make install-world
==&gt; Caveats
To use this PostgreSQL installation, do one or more of the following:</p>

<ul>
<li>Call all programs explicitly with /usr/local/opt/postgresql-9.6/bin/...</li>
<li>Add /usr/local/opt/postgresql-9.6/bin to your PATH</li>
<li>brew link -f postgresql-9.6</li>
<li>Install the postgresql-common package</li>
</ul>

<p>To access the man pages, do one or more of the following:
- Refer to them by their full path, like <code>man /usr/local/opt/postgresql-9.6/share/man/man1/psql.1</code>
- Add /usr/local/opt/postgresql-9.6/share/man to your MANPATH
- brew link -f postgresql-9.6</p>

<p>This formula is keg-only, which means it was not symlinked into /usr/local.</p>

<p>The different provided versions of PostgreSQL conflict with each other.</p>

<p>Generally there are no consequences of this for you. If you build your
own software and it requires this formula, you will need to add to your
build variables:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">LDFLAGS:  -L/usr/local/opt/postgresql-9.6/lib
CPPFLAGS: -I/usr/local/opt/postgresql-9.6/include
PKG_CONFIG_PATH: /usr/local/opt/postgresql-9.6/lib/pkgconfig
</code></pre></figure>
<p>==&gt; Summary
üç∫   /usr/local/Cellar/postgresql-9.6/9.6.1: 3,485 files, 46.6M, built in 3 minutes 38 seconds
doug@Douglass-MacBook-Pro ~ ¬ª
```</pre></noscript><script src="https://gist.github.com/hunleyd/bcc4e0e7c55e849b7adb647d9727674c.js"> </script></p>

<p>As it says in the output, these are &#39;keg-only&#39;, which has the nice side effect that they are automatically installed in side-by-side directories <code>/usr/local/opt/postgresql-9.1/</code> etc.</p>

<p>Peter configures PostgreSQL with just about all the options turned on:</p>

<p><noscript><pre>```bash
doug@Douglass-MacBook-Pro ~ ¬ª
oug@Douglass-MacBook-Pro ~ ¬ª pg_config |grep ^CONF
CONFIGURE = &#39;--prefix=/usr/local/Cellar/postgresql-9.6/9.6.1&#39; &#39;--enable-dtrace&#39; &#39;--enable-nls&#39; &#39;--with-bonjour&#39; &#39;--with-gssapi&#39; &#39;--with-ldap&#39; &#39;--with-libxml&#39; &#39;--with-libxslt&#39; &#39;--with-openssl&#39; &#39;--with-uuid=e2fs&#39; &#39;--with-pam&#39; &#39;--with-perl&#39; &#39;--with-python&#39; &#39;--with-tcl&#39; &#39;--with-includes=/usr/local/opt/gettext/include:/usr/local/opt/openldap/include:/usr/local/opt/openssl/include:/usr/local/opt/readline/include:/usr/local/opt/tcl-tk/include&#39; &#39;--with-libraries=/usr/local/opt/gettext/lib:/usr/local/opt/openldap/lib:/usr/local/opt/openssl/lib:/usr/local/opt/readline/lib:/usr/local/opt/tcl-tk/lib&#39; &#39;CC=clang&#39;
doug@Douglass-MacBook-Pro ~ ¬ª</pre></noscript><script src="https://gist.github.com/hunleyd/c56727a3249042841c2609439209c8fd.js"> </script></p>

<p>and you get all the extensions that are in &#39;contrib&#39; as well. However, if you find that you need to install another extension, I advocate using <code>pex</code>. You would install it like this:</p>

<p><noscript><pre>```bash
doug@Douglass-MacBook-Pro ~ ¬ª brew install pex
==&gt; Installing dependencies for pex: postgresql
==&gt; Installing pex dependency: postgresql
==&gt; Downloading https://homebrew.bintray.com/bottles/postgresql-9.5.5.sierra.bot
Already downloaded: /Users/doug/Library/Caches/Homebrew/postgresql-9.5.5.sierra.bottle.tar.gz
==&gt; Pouring postgresql-9.5.5.sierra.bottle.tar.gz
==&gt; Using the sandbox
==&gt; /usr/local/Cellar/postgresql/9.5.5/bin/initdb /usr/local/var/postgres
==&gt; Caveats
If builds of PostgreSQL 9 are failing and you have version 8.x installed,
you may need to remove the previous version first. See:
  https://github.com/Homebrew/homebrew/issues/2510</p>

<p>To migrate existing data from a previous major version (pre-9.0) of PostgreSQL, see:
  https://www.postgresql.org/docs/9.5/static/upgrading.html</p>

<p>To migrate existing data from a previous minor version (9.0-9.4) of PostgreSQL, see:
  https://www.postgresql.org/docs/9.5/static/pgupgrade.html</p>

<p>You will need your previous PostgreSQL installation from brew to perform <code>pg_upgrade</code>.
   Do not run <code>brew cleanup postgresql</code> until you have performed the migration.                                                                  1
To have launchd start postgresql now and restart at login:
  brew services start postgresql
Or, if you do not want/need a background service you can just run:
  pg_ctl -D /usr/local/var/postgres start
==&gt; Summary
üç∫   /usr/local/Cellar/postgresql/9.5.5: 3,154 files, 35.1M
==&gt; Installing pex
==&gt; Downloading https://homebrew.bintray.com/bottles/pex-1.20140409.sierra.bottl</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Pouring pex-1.20140409.sierra.bottle.tar.gz
==&gt; Caveats
If installing for the first time, perform the following in order to setup the necessary directory structure:
  pex init
==&gt; Summary
üç∫   /usr/local/Cellar/pex/1.20140409: 5 files, 31.6K
doug@Douglass-MacBook-Pro ~ ¬ª
doug@Douglass-MacBook-Pro ~ ¬ª pex init
doug@Douglass-MacBook-Pro ~ ¬ª
```</pre></noscript><script src="https://gist.github.com/hunleyd/37c2e01a0d400c0a16c7fb7d9b8d1030.js"> </script></p>

<p>Sadly, it will reinstall the default PostgreSQL brew recipe, but we&#39;ll simply pretend that it&#39;s not there going forward. Once installed, use <code>pex</code> like so:</p>

<p><noscript><pre>```bash
doug@Douglass-MacBook-Pro ~ ¬ª pex -g /usr/local/opt/postgresql-9.4 install ip4r
==&gt; Downloading ip4r from https://github.com/RhodiumToad/ip4r/archive/2.0.3.tar.gz</p>

<h6>################################################################## 100.0%</h6>

<p>==&gt; Unpacking ip4r
[snip]
==&gt; Building ip4r
[snip]
==&gt; Installing ip4r
[snip]
/usr/bin/install -c -m 755  ip4r.so &#39;/usr/local/Cellar/postgresql-9.4/9.4.10/lib/ip4r.so&#39;
/usr/bin/install -c -m 644 ip4r.control &#39;/usr/local/Cellar/postgresql-9.4/9.4.10/share/extension/&#39;
/usr/bin/install -c -m 644 ip4r--2.0.sql ip4r--unpackaged2.0--2.0.sql ip4r--unpackaged1--2.0.sql                                                  ‚Ü™\  &#39;/usr/local/Cellar/postgresql-9.4/9.4.10/share/extension/&#39;
[snip]
==&gt; Package ip4r installed successfully
doug@Douglass-MacBook-Pro ~ ¬ª
```</pre></noscript><script src="https://gist.github.com/hunleyd/d2d004871557adc49ae77b19181bd999.js"> </script></p>

<p>As you can see, the <code>ip4r</code> extension was installed into my PostgreSQL 9.4 instance.</p>

<p>Now, you might be wondering how to deal with all these concurrent versions. If you type <code>pg_dump</code> which one willl you get? How can you force it to use a specific version? Right now, you won&#39;t get any version, since it&#39;s not in your path. You will need to specify exactly what you want:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">doug@Douglass-MacBook-Pro ~ ¬ª /usr/local/opt/postgresql-9.6/bin/psql --version
psql (PostgreSQL) 9.6.1
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre></figure>
<p>which is a huge pita. So, let&#39;s make a little convenience function in our shell. Edit your <code>.zshrc</code> or your <code>.bashrc</code> (or whatever) and add a function like this:</p>

<p><noscript><pre>```bash
    function pg()
    {
      ver=$1</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">  for i in /usr/local/var/postgres/*
  do
    running_ver=$(basename ${i})
    is_running=$(ps -few|egrep -- &amp;quot;[p]ostgres.*-D.*${running_ver}&amp;quot;)
    if [[ ! -z ${is_running} ]] ; then
      echo -n &amp;quot;Stopping PostgreSQL ${running_ver}... &amp;quot;
      /usr/local/opt/postgresql-${running_ver}/bin/pg_ctl \
        -D $i stop -mf &amp;amp;&amp;gt;/dev/null
      echo &amp;quot;done!&amp;quot;
    fi
  done

  echo -n &amp;quot;Activating PostgreSQL ${ver}... &amp;quot;
  brew unlink --force --overwrite postgresql-${ver} &amp;amp;&amp;gt;/dev/null
  brew link --force --overwrite postgresql-${ver} &amp;amp;&amp;gt;/dev/null
  echo &amp;quot;done!&amp;quot;

  export PGDATA=/usr/local/var/postgres/${ver}

  if [[ ! -d ${PGDATA} ]] ; then
    echo -n &amp;quot;Initializing PostgreSQL ${ver} cluster... &amp;quot;
    mkdir ${PGDATA}
    initdb -k ${PGDATA} &amp;amp;&amp;gt;/dev/null || initdb ${PGDATA} &amp;amp;&amp;gt;/dev/null
    echo &amp;quot;done!&amp;quot;
  fi
  echo -n &amp;quot;Starting PostgreSQL ${ver}... &amp;quot;
  pg_ctl -D ${PGDATA} start &amp;amp;&amp;gt;/dev/null
  echo &amp;quot;done!&amp;quot;
}
</code></pre></figure>
<p>```</pre></noscript><script src="https://gist.github.com/hunleyd/b27085662bea30f3b39de293a038b766.js"> </script></p>

<p>and then simply call <code>pg 9.5</code> to set PostgreSQL 9.5 as your &#39;active&#39; instance:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">oug@Douglass-MacBook-Pro ~ ¬ª pg 9.5
Stopping PostgreSQL 9.4... done!
Activating PostgreSQL 9.5... done!
Initializing PostgreSQL 9.5 cluster... done!
Starting PostgreSQL 9.5... done!
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre></figure>
<p>Restore your data:</p>

<p><noscript><pre>404: Not Found
</pre></noscript><script src="https://gist.github.com/ihunleyd/a54dab54b0b44b7e9fd05ca54cf5fb95.js"> </script></p>

<p>and there you be. Ain&#39;t it beautiful? :)</p>

  </DIV>
  <FONT size=-1>
    <A href="/">Home</A> /
    <A href="">Getting fancy with PostgreSQL and Homebrew</A>
  </FONT>

  
  <DIV class="comments">
    <DIV id="disqus_thread"></div>
      <SCRIPT type="text/javascript">
        var disqus_shortname = 'douglashunley';

        (function() {
          var dsq = document.createElement('script');
          var dsq.type = 'text/javascript';
          var dsq.async = true
          var dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
      </SCRIPT>
      <NOSCRIPT>
        Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
      </NOSCRIPT>
    </DIV>
  </DIV>


</ARTICLE>

    </DIV>
</DIV>

    <DIV class="sidebar_container clearfix">
    <DIV class="sidebar_avatar_container">
        <A href="/"><IMG class="avatar" src="/images/avatar.png" /></A>
    </DIV>
    <DIV style="float: center; margin: 0 4px 4px 4px; padding: 0 4px 4px 4px; color: White; line-height: 1; text-align: center;">
        <I class="fa fa-mars" aria-hidden="true"></I>
        <I class="fa fa-linux" aria-hidden="true"></I>
        <I class="icon-postgres"></i>
        <I class="fa fa-android" aria-hidden="true"></I>
        <I class="fa fa-gamepad" aria-hidden="true"></I>
    </DIV>
    <DIV style="background-color: White; float: center; margin: 4px; padding: 4px; color: SteelBlue; line-height: 1;">
        <FONT style="font-size: 50%">
            Feeds:
            <BR/>&nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A href="/feeds/feed.xml">EVERYTHING</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.general.xml">general</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.geek.xml">geek</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.kickstarter.xml">kickstarter</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.review.xml">review</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.android.xml">android</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.work.xml">work</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.computers.xml">computers</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.osx.xml">osx</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.linux.xml">linux</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.networking.xml">networking</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.crowdfunding.xml">crowdfunding</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.postgresql.xml">postgresql</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.replication.xml">replication</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.howto.xml">howto</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.nexus5x.xml">nexus5x</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.protip.xml">protip</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.blog.xml">blog</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.github.xml">github</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.gaming.xml">gaming</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.biking.xml">biking</A>
            
              &nbsp;<I class="fa fa-rss" aria-hidden="true"></I>&nbsp;<A style="text-transform: uppercase" href="/feeds/feed.pgcmh.xml">pgcmh</A>
            
        </FONT>
    </DIV>
    <DIV style="background-color: White; float: center; margin: 4px; padding: 4px; color: SteelBlue; line-height: 1;">
        <FONT style="font-size: 50%">
            Archives:
            
              
              <BR />&nbsp;<I class="fa fa-calendar" aria-hidden="true"></I>
              <A href="/archives/2017">2017</A>
              
            
              
                
                
                
                <BR />&nbsp;<I class="fa fa-calendar" aria-hidden="true"></I>
                <A href="/archives/2016">2016</A>
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
        </FONT>
    </DIV>
    <DIV style="background-color: White; float: center; margin: 4px; padding: 4px; color: SteelBlue; line-height: 1;">
        
          <A style="font-size: 92%" href="/tags/general">general</a> &centerdot;&nbsp;
        
          <A style="font-size: 64%" href="/tags/geek">geek</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/kickstarter">kickstarter</a> &centerdot;&nbsp;
        
          <A style="font-size: 64%" href="/tags/review">review</a> &centerdot;&nbsp;
        
          <A style="font-size: 69%" href="/tags/android">android</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/work">work</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/computers">computers</a> &centerdot;&nbsp;
        
          <A style="font-size: 73%" href="/tags/osx">osx</a> &centerdot;&nbsp;
        
          <A style="font-size: 54%" href="/tags/linux">linux</a> &centerdot;&nbsp;
        
          <A style="font-size: 54%" href="/tags/networking">networking</a> &centerdot;&nbsp;
        
          <A style="font-size: 54%" href="/tags/crowdfunding">crowdfunding</a> &centerdot;&nbsp;
        
          <A style="font-size: 121%" href="/tags/postgresql">postgresql</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/replication">replication</a> &centerdot;&nbsp;
        
          <A style="font-size: 64%" href="/tags/howto">howto</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/nexus5x">nexus5x</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/protip">protip</a> &centerdot;&nbsp;
        
          <A style="font-size: 64%" href="/tags/blog">blog</a> &centerdot;&nbsp;
        
          <A style="font-size: 54%" href="/tags/github">github</a> &centerdot;&nbsp;
        
          <A style="font-size: 54%" href="/tags/gaming">gaming</a> &centerdot;&nbsp;
        
          <A style="font-size: 54%" href="/tags/biking">biking</a> &centerdot;&nbsp;
        
          <A style="font-size: 59%" href="/tags/pgcmh">pgcmh</a> &centerdot;&nbsp;
        
    </DIV>
</DIV>

</DIV>

        <DIV class="footer_container">
    <UL class="tag_list_in_post">
        
            <LI class="tag_list_item">
                <A href="https://dhunley.deviantart.com/"><I class="fa fa-deviantart" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://facebook.com/douglas.j.hunley"><I class="fa fa-facebook" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://github.com/hunleyd"><I class="fa fa-github" aria-hidden="true"></I></A>
            </LI>
        
        
        
            <LI class="tag_list_item">
                <A href="https://instagram.com/doughunley"><I class="fa fa-instagram" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="http://www.last.fm/user/hunleyd"><I class="fa fa-lastfm" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://www.linkedin.com/in/dhunley"><I class="fa fa-linkedin" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://www.meetup.com/members/43608152"><I class="fa fa-meetup" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://reddit.com//u/hunleyd"><I class="fa fa-reddit-alien" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://twitter.com/hunleyd"><I class="fa fa-twitter" aria-hidden="true"></I></A>
            </LI>
        
        
            <LI class="tag_list_item">
                <A href="https://youtube.com/user/doughunley"><I class="fa fa-youtube" aria-hidden="true"></I></A>
            </LI>
        
    </UL>
    <P style="font-size: 50%;">
        Site built with <A href="https://jekyllrb.com">Jekyll</A> and served via <A href="https://github.com">GitHub</A>. 
        <BR />
        &copy; 2017. All rights reserved.
    </P>
</DIV>

    </DIV>
</BODY>

</HTML>

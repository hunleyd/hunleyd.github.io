<p>After a lively discussion at work today about monitoring tools and use cases, I decided to see if I could use <a href="https://bucardo.org/tail_n_mail/">tail_n_mail</a>, which I already use to monitor my PostgreSQL logs, to monitor my pgBackRest logs. It turns out that it can, and can do so fairly trivially.</p>

<p>For reference, our <code class="highlighter-rouge">.tail_n_mail.conf</code> looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Config file for the tail_n_mail program
## This file is automatically updated
LOG_LINE_PREFIX: %t P%p
EMAIL: you@gme.com
MAILSUBJECT: HOST pgBackRest errors NUMBER

INCLUDE: WARN:
INCLUDE: ERROR:
INCLUDE: FATAL:
INCLUDE: PANIC:


FILE1: /var/log/pgbackrest/pgbackrest.log
</code></pre></div></div>

<p>You would need to change the <code class="highlighter-rouge">EMAIL</code> and <code class="highlighter-rouge">FILE1</code> and the rest should just work.</p>

<p>To actually invoke the monitoring, simply add a <code class="highlighter-rouge">cron</code> entry that looks like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* * * * * /path/to/tail_n_mail ~/.tailnmail.conf --pgmode=0
</code></pre></div></div>

<p>(Obviously, you should adjust the periodicity. I <strong>highly</strong> doubt you need to check every minute.)</p>

<p>Once youâ€™ve saved the <code class="highlighter-rouge">crontab</code>, you should be all good. If you doubt the setup, you can add <code class="highlighter-rouge">--mailzero</code> to the invocation to get an email even if everything is OK.</p>

<p>See? Easy.</p>

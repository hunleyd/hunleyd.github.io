<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title> - page 2 &#8211; Douglas J Hunley</title>
<meta name="description" content="Describe this nonsense.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/abstract-1.jpg">

<meta name="twitter:title" content=" - page 2">
<meta name="twitter:description" content="Describe this nonsense.">
<meta name="twitter:creator" content="@hunleyd">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content=" - page 2">
<meta property="og:description" content="Describe this nonsense.">
<meta property="og:url" content="/pages/2/index.html">
<meta property="og:site_name" content="Douglas J Hunley">





<link rel="canonical" href="/pages/2/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Douglas J Hunley Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<NAV id="dl-menu" class="dl-menuwrapper" role="navigation">
  <BUTTON class="dl-trigger">
    Open Menu
  </BUTTON>
  <UL class="dl-menu">
    <LI>
      <A href="/">Home</A>
    </LI>
    <LI>
      <A href="#">About</A>
      <UL class="dl-submenu">
        <LI>
          <IMG src="/images/avatar.jpg" alt="Douglas J Hunley photo" class="author-photo" />
          <H4>Douglas J Hunley</H4>
          <P>Linux Sys Admin, Gentoo user, PostgreSQL advocate, Android fanboi, OSS supporter, PlayStation gamer</P>
        </LI>
        <LI>
          <A href="/about/"><SPAN class="btn btn-inverse">Learn More</SPAN></A>
        </LI>
        
          <LI>
            <A href="https://dhunley.deviantart.com"><I class="fa fa-deviantart" aria-hidden="true"></I> DeviantArt</A>
          </LI>
        
        
          <LI>
            <A href="mailto:douglas.hunley@gmail.com"><I class="fa fa-envelope" aria-hidden="true"></I> Email</A>
          </LI>
        
        
          <LI>
            <A href="https://facebook.com/douglas.j.hunley"><I class="fa fa-facebook" aria-hidden="true"></I> Facebook</A>
          </LI>
        
        
        
          <LI>
            <A href="https://github.com/hunleyd"><I class="fa fa-github" aria-hidden="true"></I> GitHub</A>
          </LI>
        
        
          <LI>
            <A href="https://google.com/+DouglasHunley"><I class="fa fa-google-plus" aria-hidden="true"></I> Google+</A>
          </LI>
        
        
          <LI>
            <A href="https://instagram.com/doughunley"><I class="fa fa-instagram" aria-hidden="true"></I> Instagram</A>
          </LI>
        
        
          <LI>
            <A href="https://linkedin.com/in/dhunley"><I class="fa fa-linkedin" aria-hidden="true"></I> LinkedIn</A>
          </LI>
        
        
          <LI>
            <A href="https://meetup.com/members/43608152"><I class="fa fa-meetup" aria-hidden="true"></I> MeetUp</A>
          </LI>
        
        
          <LI>
            <A href="https://reddit.com/u/hunleyd"><I class="fa fa-reddit-alien" aria-hidden="true"></I> Reddit</A>
          </LI>
        
        
        
        
          <LI>
            <A href="https://twitter.com/hunleyd"><I class="fa fa-twitter" aria-hidden="true"></I> Twitter</A>
          </LI>
        
        
          <LI>
            <A href="https://youtube.com/user/doughunley"><I class="fa fa-youtube" aria-hidden="true"></I> YouTube</A>
          </LI>
        
      </UL><!-- /.dl-submenu -->
    </LI>
    <LI>
      <A href="#">Posts</A>
      <UL class="dl-submenu">
        <LI>
          <A href="/posts/">All Posts</A>
        </LI>
        <LI>
          <A href="/tags/">All Tags</A>
        </LI>
      </UL>
    </LI>
    
  </UL><!-- /.dl-menu -->
</NAV><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="/images/abstract-1.jpg" alt=" - page 2">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Douglas J Hunley</h1>
      <h2> - page 2</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
  <ARTICLE class="hentry">
    <HEADER>
      
        <DIV class="entry-image-index">
          <A href="/posts/Upgrading-PostgreSQL-5x-faster/" title="Upgrading PostgreSQL 5x faster"><IMG src="/images/db.jpg" alt="Upgrading PostgreSQL 5x faster" /></A>
        </DIV><!-- /.entry-image -->
      
      <DIV class="entry-meta">
        <SPAN class="entry-date date published updated">
          <TIME datetime="2016-11-18T07:18:28-05:00" />
            <A href="/posts/Upgrading-PostgreSQL-5x-faster/">November 18, 2016</A>
          </TIME>
        </SPAN>
        <SPAN class="author vcard">
          <SPAN class="fn">
            <A href="/about/" title="About Douglas J Hunley">Douglas J Hunley</A>
          </SPAN>
        </SPAN>
        
          <SPAN class="entry-reading-time">
            <I class="fa fa-clock-o"></i>
            
Reading time ~2 minutes
          </SPAN><!-- /.entry-reading-time -->
        
      </DIV><!-- /.entry-meta -->
      
        <H1 class="entry-title">
          <A href="/posts/Upgrading-PostgreSQL-5x-faster/" rel="bookmark" title="Upgrading PostgreSQL 5x faster" itemprop="url">Upgrading PostgreSQL 5x faster</A>
        </H1>
      
    </HEADER>
    <DIV class="entry-content">
      <p><img src="http://www.navops.io/img/launch-samsung-1.gif" class="lleader" />Upgrading your PostgreSQL database from one major version (e.g. 9.4.x) to another major version (e.g. 9.5.x) used to a painful and exceedingly slow process. You essentially had two options: dump / reload the data or use one of the complex logical replication tools.</p>

<p>Thankfully, the PostgreSQL team introduced <code class="highlighter-rouge">pg_upgrade</code> back in version 9.0. Because the way data is stored internally in its datafiles in PostgreSQL rarely changes, <code class="highlighter-rouge">pg_upgrade</code> is able to re-use the existing datafiles (while manipulating some catalog entries) to ‚Äúshort circuit‚Äù the upgrade process. While this isn‚Äôt (yet) a true ‚Äúin place upgrade‚Äù as done by some other databases, it‚Äôs pretty close. And it‚Äôs stupid fast. In my testing on my overworked Macbook Pro, it took <em>1/5</em> as long to upgrade as a traditional dump and reload. So, let‚Äôs look at this process shall we?</p>

<p>First, we assume that we have both PostgreSQL 9.5 and 9.6 installed and both have initialized (empty) clusters (see <a href="https://hunleyd.github.io/Getting-fancy-with-PostgreSQL-and-Homebrew/">here</a> if you need to do this). We‚Äôre going to use <code class="highlighter-rouge">pgbench</code> to create some data in our PostgreSQL 9.5 instance:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~/foo ¬ª pg 9.5
doug@Douglass-MacBook-Pro ~/foo ¬ª createdb bench1; createdb bench2; createdb bench3
doug@Douglass-MacBook-Pro ~/foo ¬ª pgbench -i -s 15 bench1 ; pgbench -i -s 70 bench2 ; pgbench -i -s 600 bench3
doug@Douglass-MacBook-Pro ~/foo ¬ª pgbench -c 4 -j 2 -T 600 bench1 ; pgbench -c 4 -j 2 -T 600 bench2 ; pgbench -c 4 -j 2 -T 600 bench3
</code></pre>
</div>

<p>Now that we‚Äôve got data in our cluster, we can do the dump. If this were a production instance, <em>this is where you‚Äôd have to stop your application(s)</em>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~/foo ¬ª time pg_dumpall &gt; data.sql
pg_dumpall &gt; data.sql  20.57s user 30.63s system 4% cpu 18:43.70 total
</code></pre>
</div>

<p>We‚Äôve now dumped out all our data, and spent 18 minutes with the application(s) down. Let‚Äôs restore our data to the PostgreSQL 9.6 cluster now:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~/foo ¬ª pg 9.6
doug@Douglass-MacBook-Pro ~/foo ¬ª time psql -f data.sql
psql -f data.sql  14.53s user 18.30s system 1% cpu 37:48.49 total
</code></pre>
</div>

<p>After 37 minutes, our data is back and we can start our applications back up. <em>An outage of approximately 56.5 minutes</em>.</p>

<p>Now, let‚Äôs blow away our PostgreSQL 9.6 cluster and use <code class="highlighter-rouge">pg_upgrade</code> to complete the same task. You would do this with the application(s) down as well!</p>

<div class="highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~/foo ¬ª rm -fr $PGDATA/*
doug@Douglass-MacBook-Pro ~/foo ¬ª initdb $PGDATA
doug@Douglass-MacBook-Pro ~/foo ¬ª export OPGDATA=$PGDATA/../9.5
doug@Douglass-MacBook-Pro ~/foo ¬ª time pg_upgrade -d $OPGDATA -D $PGDATA -b /usr/local/opt/postgresql-9.5/bin -B /usr/local/opt/postgresql-9.6/bin
pg_upgrade -d $OPGDATA -D $PGDATA -b /usr/local/opt/postgresql-9.5/bin -B   0.40s user 12.12s system 1% cpu 10:26.64 total
</code></pre>
</div>

<p>And we‚Äôre done <em>in 10.5 minutes</em>. It took 1/5 the outage of the dump / load method. And that‚Äôs on my puny dataset with my overworked laptop! Pretty impressive, no?</p>

<p>For the curious, the <code class="highlighter-rouge">pg_upgrade</code> output that I omitted above for readability‚Äôs sake is:</p>

<p>true<script src="https://gist.github.com/hunleyd/3ff1f5503fc42e3446b35715bd0ec932.js"> </script></p>

    </DIV><!-- /.entry-content -->
  </ARTICLE><!-- /.hentry -->

  <ARTICLE class="hentry">
    <HEADER>
      
        <DIV class="entry-image-index">
          <A href="/posts/Managing-multiple-PostgreSQL-installs-via-Homebrew/" title="Managing multiple PostgreSQL installs via Homebrew"><IMG src="/images/db.jpg" alt="Managing multiple PostgreSQL installs via Homebrew" /></A>
        </DIV><!-- /.entry-image -->
      
      <DIV class="entry-meta">
        <SPAN class="entry-date date published updated">
          <TIME datetime="2016-11-16T08:45:27-05:00" />
            <A href="/posts/Managing-multiple-PostgreSQL-installs-via-Homebrew/">November 16, 2016</A>
          </TIME>
        </SPAN>
        <SPAN class="author vcard">
          <SPAN class="fn">
            <A href="/about/" title="About Douglas J Hunley">Douglas J Hunley</A>
          </SPAN>
        </SPAN>
        
          <SPAN class="entry-reading-time">
            <I class="fa fa-clock-o"></i>
            
Reading time ~1 minute
          </SPAN><!-- /.entry-reading-time -->
        
      </DIV><!-- /.entry-meta -->
      
        <H1 class="entry-title">
          <A href="/posts/Managing-multiple-PostgreSQL-installs-via-Homebrew/" rel="bookmark" title="Managing multiple PostgreSQL installs via Homebrew" itemprop="url">Managing multiple PostgreSQL installs via Homebrew</A>
        </H1>
      
    </HEADER>
    <DIV class="entry-content">
      <p><img src="http://cdn.curvve.com/wp-content/uploads/2013/09/homebrew_osx_logo.png" class="rleader" />Following on from <a href="https://hunleyd.github.io/Getting-fancy-with-PostgreSQL-and-Homebrew/">this</a> post, you probably have multiple versions of PostgreSQL installed on your Mac. In that post, I added an example function to help you manage all these concurrent installs. Today, I‚Äôm back with a full-fledged shell script to help manage all this. Without further ado, the script:</p>

<p>true<script src="https://gist.github.com/hunleyd/0ee7d8745c2f9854b34ed48ae9196362.js"> </script></p>

<p>But what does it do? It‚Äôs pretty simple actually. When you call this script, you tell it what version of PostgreSQL you want:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~ ¬ª pg 9.6
</code></pre>
</div>

<p>and then the script does the following:</p>

<ul>
  <li>checks if the requested version is installed, and installs it if not</li>
  <li>checks if another version of PostgreSQL is running, and stops it</li>
  <li>checks if another version is linked as the active version, and unlinks it</li>
  <li>links the requested version as the active version</li>
  <li>sets PGDATA to point to the requested version‚Äôs data cluster</li>
  <li>does an <code class="highlighter-rouge">initdb</code> for the requested version if needed</li>
  <li>starts the requested version‚Äôs cluster</li>
</ul>

<p>I‚Äôll be the first to admit that the script could use additional work, but it‚Äôs functional enough to start using today. As I continue to improve the script, I‚Äôll update the gist with those changes, so check back every so often.</p>

<p>Enjoy.</p>

    </DIV><!-- /.entry-content -->
  </ARTICLE><!-- /.hentry -->

  <ARTICLE class="hentry">
    <HEADER>
      
        <DIV class="entry-image-index">
          <A href="/posts/Routing-email-through-GMail-on-OSX/" title="Routing email through GMail on OSX"><IMG src="/images/tech.jpg" alt="Routing email through GMail on OSX" /></A>
        </DIV><!-- /.entry-image -->
      
      <DIV class="entry-meta">
        <SPAN class="entry-date date published updated">
          <TIME datetime="2016-11-15T05:51:00-05:00" />
            <A href="/posts/Routing-email-through-GMail-on-OSX/">November 15, 2016</A>
          </TIME>
        </SPAN>
        <SPAN class="author vcard">
          <SPAN class="fn">
            <A href="/about/" title="About Douglas J Hunley">Douglas J Hunley</A>
          </SPAN>
        </SPAN>
        
          <SPAN class="entry-reading-time">
            <I class="fa fa-clock-o"></i>
            
Reading time ~1 minute
          </SPAN><!-- /.entry-reading-time -->
        
      </DIV><!-- /.entry-meta -->
      
        <H1 class="entry-title">
          <A href="/posts/Routing-email-through-GMail-on-OSX/" rel="bookmark" title="Routing email through GMail on OSX" itemprop="url">Routing email through GMail on OSX</A>
        </H1>
      
    </HEADER>
    <DIV class="entry-content">
      <p><img src="http://www.postfix.org/mysza.gif" class="lleader" />Like most geeks, I have scripts that I‚Äôve written that I like to have run from cron on a regular basis. And since the running of these scripts might be in the middle of the night, I like for them to email their output to me so I know if they succeeded or failed. As such, I need an MTA on my computer that can actually deliver these emails to GMail. For me, this is trivial using Sendmail or SSMTP on a Linux box, but I can never remember how to do this using Postfix on OSX. So after having to Google everything to get this running once more, I‚Äôm going to commit the steps here for my future self to reference :)</p>

<p>The first thing we‚Äôre going to do is open an iTerm and <code class="highlighter-rouge">sudo -i</code> to become root. Then we‚Äôre going to <code class="highlighter-rouge">vi /etc/postfix/main.cf</code> and we‚Äôre going to add/set the following:</p>

<div class="language-conf highlighter-rouge"><pre class="highlight"><code><span class="n">myhostname</span> = <span class="n">smtp</span>.<span class="n">gmail</span>.<span class="n">com</span>
<span class="n">relayhost</span> = [<span class="n">smtp</span>.<span class="n">gmail</span>.<span class="n">com</span>]:<span class="m">587</span>
<span class="n">smtp_sasl_auth_enable</span> = <span class="n">yes</span>
<span class="n">smtp_sasl_password_maps</span>= <span class="n">hash</span>:/<span class="n">etc</span>/<span class="n">postfix</span>/<span class="n">sasl_passwd</span>
<span class="n">smtp_sasl_security_options</span> = <span class="n">noanonymous</span>
<span class="n">smtp_sasl_mechanism_filter</span> = <span class="n">plain</span>
<span class="n">smtp_use_tls</span> = <span class="n">yes</span>
</code></pre>
</div>

<p>I have Two-Factor Auth (2FA) enabled on my Google account (you should too!), so for me, the next step is to log into Google and create an ‚Äòapp password‚Äô. Once I have that password in hand, we <code class="highlighter-rouge">vi /etc/postfix/sasl_passwd</code> and add:</p>

<div class="language-conf highlighter-rouge"><pre class="highlight"><code>[<span class="n">smtp</span>.<span class="n">gmail</span>.<span class="n">com</span>]:<span class="m">587</span> <span class="n">username</span>@<span class="n">gmail</span>.<span class="n">com</span>:<span class="n">app_passwd</span>
</code></pre>
</div>

<p>Secure that file by running <code class="highlighter-rouge">chmod 0600 /etc/postfix/sasl_passwd</code> and then have Postfix hash it by doing <code class="highlighter-rouge">postmap /etc/postfix/sasl_passwd</code>. Finally, restart Postfix:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>launchctl stop org.postfix.master
launchctl start org.postfix.master
</code></pre>
</div>

<p>And everything should work.</p>

    </DIV><!-- /.entry-content -->
  </ARTICLE><!-- /.hentry -->

  <ARTICLE class="hentry">
    <HEADER>
      
        <DIV class="entry-image-index">
          <A href="/posts/Getting-fancy-with-PostgreSQL-and-Homebrew/" title="Getting fancy with PostgreSQL and Homebrew"><IMG src="/images/db.jpg" alt="Getting fancy with PostgreSQL and Homebrew" /></A>
        </DIV><!-- /.entry-image -->
      
      <DIV class="entry-meta">
        <SPAN class="entry-date date published updated">
          <TIME datetime="2016-11-10T09:58:15-05:00" />
            <A href="/posts/Getting-fancy-with-PostgreSQL-and-Homebrew/">November 10, 2016</A>
          </TIME>
        </SPAN>
        <SPAN class="author vcard">
          <SPAN class="fn">
            <A href="/about/" title="About Douglas J Hunley">Douglas J Hunley</A>
          </SPAN>
        </SPAN>
        
          <SPAN class="entry-reading-time">
            <I class="fa fa-clock-o"></i>
            
Reading time ~2 minutes
          </SPAN><!-- /.entry-reading-time -->
        
      </DIV><!-- /.entry-meta -->
      
        <H1 class="entry-title">
          <A href="/posts/Getting-fancy-with-PostgreSQL-and-Homebrew/" rel="bookmark" title="Getting fancy with PostgreSQL and Homebrew" itemprop="url">Getting fancy with PostgreSQL and Homebrew</A>
        </H1>
      
    </HEADER>
    <DIV class="entry-content">
      <p><img src="http://cdn.curvve.com/wp-content/uploads/2013/09/homebrew_osx_logo.png" class="rleader" />In our <a href="https://hunleyd.github.io/PostgreSQL-Homebrew-and-You/">previous</a> post, we installed PostgreSQL via Homebrew and got our own little cluster up and running under our userid. That is probably good enough for 90% of the users out there who just want to play with or devel on PostgreSQL, but for those of us who need a little more flexibility in our installs, we‚Äôre going to take the next step.</p>

<p>First, if you have any data in your existing cluster that you want to preserve, let‚Äôs backup it up. We‚Äôre just going to use <code class="highlighter-rouge">pg_dumpall</code> here since it‚Äôs quick-n-dirty:</p>

<p>true<script src="https://gist.github.com/hunleyd/22e765b45c877b5c9c2e35722b464393.js"> </script></p>

<p>Now, we can stop our cluster:</p>

<p>true<script src="https://gist.github.com/hunleyd/f02a36a115c3fed3310e7abc5f3fb419.js"> </script></p>

<p>And uninstall the current PostgreSQL:</p>

<p>true<script src="https://gist.github.com/hunleyd/4dffee8e9ebbf2c052162f2ecc36e812.js"> </script></p>

<p>And remove the remnants of our cluster:</p>

<p>true<script src="https://gist.github.com/hunleyd/7c064e25c8916fa7fe0e3cdb846d3c78.js"> </script></p>

<p>Now we‚Äôve got a clean slate. So, let‚Äôs tell Homebrew to stop using the default PostgreSQL and use Peter Eisentraut‚Äôs version (if you don‚Äôt know, Peter actually contributes to PostgreSQL):</p>

<p>true<script src="https://gist.github.com/hunleyd/b099ff10c1cd1713f37ff40cf320adf3.js"> </script></p>

<p>As of this writing, Peter makes PostgreSQL 8.3 and above available. However, only PostgreSQL 9.2 and above are officially supported by the PostgreSQL community. So let‚Äôs install the supported versions:</p>

<p>true<script src="https://gist.github.com/hunleyd/bcc4e0e7c55e849b7adb647d9727674c.js"> </script></p>

<p>As it says in the output, these are ‚Äòkeg-only‚Äô, which has the nice side effect that they are automatically installed in side-by-side directories <code class="highlighter-rouge">/usr/local/opt/postgresql-9.1/</code> etc.</p>

<p>Peter configures PostgreSQL with just about all the options turned on:</p>

<p>true<script src="https://gist.github.com/hunleyd/c56727a3249042841c2609439209c8fd.js"> </script></p>

<p>and you get all the extensions that are in ‚Äòcontrib‚Äô as well. However, if you find that you need to install another extension, I advocate using <code class="highlighter-rouge">pex</code>. You would install it like this:</p>

<p>true<script src="https://gist.github.com/hunleyd/37c2e01a0d400c0a16c7fb7d9b8d1030.js"> </script></p>

<p>Sadly, it will reinstall the default PostgreSQL brew recipe, but we‚Äôll simply pretend that it‚Äôs not there going forward. Once installed, use <code class="highlighter-rouge">pex</code> like so:</p>

<p>true<script src="https://gist.github.com/hunleyd/d2d004871557adc49ae77b19181bd999.js"> </script></p>

<p>As you can see, the <code class="highlighter-rouge">ip4r</code> extension was installed into my PostgreSQL 9.4 instance.</p>

<p>Now, you might be wondering how to deal with all these concurrent versions. If you type <code class="highlighter-rouge">pg_dump</code> which one willl you get? How can you force it to use a specific version? Right now, you won‚Äôt get any version, since it‚Äôs not in your path. You will need to specify exactly what you want:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~ ¬ª /usr/local/opt/postgresql-9.6/bin/psql --version
psql <span class="o">(</span>PostgreSQL<span class="o">)</span> 9.6.1
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre>
</div>

<p>which is a huge pita. So, let‚Äôs make a little convenience function in our shell. Edit your <code class="highlighter-rouge">.zshrc</code> or your <code class="highlighter-rouge">.bashrc</code> (or whatever) and add a function like this:</p>

<p>true<script src="https://gist.github.com/hunleyd/b27085662bea30f3b39de293a038b766.js"> </script></p>

<p>and then simply call <code class="highlighter-rouge">pg 9.5</code> to set PostgreSQL 9.5 as your ‚Äòactive‚Äô instance:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>oug@Douglass-MacBook-Pro ~ ¬ª pg 9.5
Stopping PostgreSQL 9.4... <span class="k">done</span>!
Activating PostgreSQL 9.5... <span class="k">done</span>!
Initializing PostgreSQL 9.5 cluster... <span class="k">done</span>!
Starting PostgreSQL 9.5... <span class="k">done</span>!
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre>
</div>

<p>Restore your data:</p>

<p>true<script src="https://gist.github.com/ihunleyd/a54dab54b0b44b7e9fd05ca54cf5fb95.js"> </script></p>

<p>and there you be. Ain‚Äôt it beautiful? :)</p>

    </DIV><!-- /.entry-content -->
  </ARTICLE><!-- /.hentry -->

  <ARTICLE class="hentry">
    <HEADER>
      
        <DIV class="entry-image-index">
          <A href="/posts/PostgreSQL-Homebrew-and-You/" title="PostgreSQL, Homebrew, and You"><IMG src="/images/db.jpg" alt="PostgreSQL, Homebrew, and You" /></A>
        </DIV><!-- /.entry-image -->
      
      <DIV class="entry-meta">
        <SPAN class="entry-date date published updated">
          <TIME datetime="2016-11-04T09:30:09-04:00" />
            <A href="/posts/PostgreSQL-Homebrew-and-You/">November 04, 2016</A>
          </TIME>
        </SPAN>
        <SPAN class="author vcard">
          <SPAN class="fn">
            <A href="/about/" title="About Douglas J Hunley">Douglas J Hunley</A>
          </SPAN>
        </SPAN>
        
          <SPAN class="entry-reading-time">
            <I class="fa fa-clock-o"></i>
            
Reading time ~2 minutes
          </SPAN><!-- /.entry-reading-time -->
        
      </DIV><!-- /.entry-meta -->
      
        <H1 class="entry-title">
          <A href="/posts/PostgreSQL-Homebrew-and-You/" rel="bookmark" title="PostgreSQL, Homebrew, and You" itemprop="url">PostgreSQL, Homebrew, and You</A>
        </H1>
      
    </HEADER>
    <DIV class="entry-content">
      <p><img src="http://cdn.curvve.com/wp-content/uploads/2013/09/homebrew_osx_logo.png" class="lleader" />If you need to install <a href="http://www.posatgresql.org">PostgreSQL</a> onto your Macbook, you have several options available to you nowadays. You could use the <a href="https://bigsql.com/postgresql/installers.jsp">BigSQL</a> package, or you could use <a href="http://postgresapp.com">Postgres.app</a>, or several others. However, if you‚Äôre a geek running OSX, you‚Äôve probably already installed <a href="http://brew.sh">Homebrew</a> and it has a wonderful PostgreSQL package. So let‚Äôs use it, shall we?</p>

<p>I‚Äôm not going to walk you through installing Homebrew, so let‚Äôs just assume it‚Äôs already up and running and you‚Äôve followed all the directions. At this point, you have <code class="highlighter-rouge">/usr/local/bin/</code> in your <code class="highlighter-rouge">$PATH</code> and <code class="highlighter-rouge">brew</code> is up and running. So, let‚Äôs tell <code class="highlighter-rouge">brew</code> to install PostgreSQL:</p>

<div class="language-text highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~ ¬ª brew install postgresql
==&gt; Downloading https://homebrew.bintray.com/bottles/postgresql-9.5.4_1.sierra.b
Already downloaded: /Users/doug/Library/Caches/Homebrew/postgresql-9.5.4_1.sierra.bottle.tar.gz
==&gt; Pouring postgresql-9.5.4_1.sierra.bottle.tar.gz
==&gt; Using the sandbox
==&gt; /usr/local/Cellar/postgresql/9.5.4_1/bigsqln/initdb /usr/local/var/postgres
==&gt; Caveats
If builds of PostgreSQL 9 are failing and you have version 8.x installed,
you may need to remove the previous version first. See:
  https://github.com/Homebrew/homebrew/issues/2510

To migrate existing data from a previous major version (pre-9.0) of PostgreSQL, see:
  https://www.postgresql.org/docs/9.5/static/upgrading.html

To migrate existing data from a previous minor versionn (9.0-9.4) of PostgreSQL, see:
  https://www.postgresql.org/docs/9.5/static/pgupgrade.html

  You will need your previous PostgreSQL installation from brew to perform `pg_upgrade`.
  Do not run `brew cleanup postgresql` until you have performed the migration.

To have launchd start postgresql now and restart at login:
  brew services start postgresql
Or, if you don't want/need a background service you can just run:
  pg_ctl -D /usr/local/var/postgres start
==&gt; Summary
üç∫  /usr/local/Cellar/postgresql/9.5.4_1: 3,147 files, 35M
</code></pre>
</div>

<p>As you can see, it downloaded the package, installed the binaries, and ran <code class="highlighter-rouge">initdb</code> for us! As the output tells us, we can set PostgreSQL to auto-start when we login by issuing:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~ ¬ª brew services start postgresql
<span class="gp">==&gt; </span>Successfully started <span class="sb">`</span>postgresql<span class="sb">`</span> <span class="o">(</span>label: homebrew.mxcl.postgresql<span class="o">)</span>
</code></pre>
</div>

<p>And if you check your process listing, you can see that the cluster is up and running under your id:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>doug@Douglass-MacBook-Pro ~ ¬ª ps -efw|grep postgres
  501  6808     1   0 11:03AM ??         0:00.02 /usr/local/opt/postgresql/bin/postgres -D /usr/local/var/postgres
  501  6817  6808   0 11:03AM ??         0:00.00 postgres: logger process
  501  6819  6808   0 11:03AM ??         0:00.00 postgres: checkpointer process
  501  6820  6808   0 11:03AM ??         0:00.00 postgres: writer process
  501  6821  6808   0 11:03AM ??         0:00.00 postgres: wal writer process
  501  6822  6808   0 11:03AM ??         0:00.00 postgres: autovacuum launcher process
  501  6823  6808   0 11:03AM ??         0:00.00 postgres: stats collector process
doug@Douglass-MacBook-Pro ~ ¬ª
</code></pre>
</div>

<p>And just like that, you have PostgreSQL installed and running! Set <code class="highlighter-rouge">$PGDATA</code> to <code class="highlighter-rouge">/usr/local/var/postgres</code> and you‚Äôre all set.</p>

<p>Enjoy!</p>

    </DIV><!-- /.entry-content -->
  </ARTICLE><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="">1</a></li>
    

    
    

    
    
    

    
      
        <li><strong class="current-page">2</strong></li>
      
    
      
        
        
        
        <li><a href="/pages/3/">3</a></li>
      
    
      
        
        
        
        <li><a href="/pages/4/">4</a></li>
      
    

    
    
      <li>‚Ä¶</li>
    

    
      <li><a href="/pages/7/">7</a></li>
    

    
    
      <li><a href="/pages/3/" class="btn">Next</a></li>
    
  </ul>
</div>



</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Douglas J Hunley.<BR /><FONT size=-1>Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a>. Served via <a href="https://github.com">GitHub</a>. Themed using <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR</a>.</FONT></span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>



          

</body>
</html>